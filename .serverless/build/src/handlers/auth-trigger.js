"use strict";var s=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var c=(r,e)=>{for(var o in e)s(r,o,{get:e[o],enumerable:!0})},m=(r,e,o,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of l(e))!u.call(r,n)&&n!==o&&s(r,n,{get:()=>e[n],enumerable:!(t=a(e,n))||t.enumerable});return r};var g=r=>m(s({},"__esModule",{value:!0}),r);var f={};c(f,{postConfirmation:()=>b});module.exports=g(f);var i=require("@prisma/client"),p=new i.PrismaClient,b=async r=>{console.log("Event received:",JSON.stringify(r));try{let{sub:e,email:o,name:t}=r.request.userAttributes;if(!o)return console.log("Kh\xF4ng c\xF3 email trong userAttributes, b\u1ECF qua."),r;await p.user.upsert({where:{email:o},update:{name:t||o.split("@")[0]},create:{id:e,email:o,name:t||o.split("@")[0]||"Unknown User"}}),console.log(`\u0110\xE3 \u0111\u1ED3ng b\u1ED9 user ${o} (Sub: ${e}) v\xE0o DB`)}catch(e){console.error("L\u1ED7i \u0111\u1ED3ng b\u1ED9 DB:",e)}return r};0&&(module.exports={postConfirmation});
